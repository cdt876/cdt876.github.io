<!DOCTYPE PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   SYSTEM "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
        <title>GSA File Manager</title>

        <!--BEGIN STYLESHEET/SCRIPT-->
        <!--LOAD THREE STYLESHEETS, 1 COMMON, 1 FOR NETSCAPE, 1 FOR IE-->
<!--        <link rel="stylesheet" type="text/css" href="/images/w3/v6/css/w3_common.css" />
        <link rel="stylesheet" type="text/css" href="/images/w3/v6/css/w3_netscape.css" disabled />
-->
        <script language="JavaScript1.2" type="text/javascript">
        <!--
//                if (document.all) document.createStyleSheet("/images/w3/v6/css/w3_ie.css");
        //-->
        </script>
        <!--END STYLESHEET/SCRIPT-->
</head>

<body bgcolor="#FFFFFF" marginheight="0" marginwidth="0" leftmargin="0" topmargin="0">

<!--BEGIN CONTENT SHELL-->
<CENTER>
                        <BODY BGCOLOR=#FFFFFF>
<script type="text/javaScript" src="/ui/v8/scripts/scripts.js"></script>
<SCRIPT SRC="/gsatools/Cookies.js"></SCRIPT>
<script src="/gsatools/Posix.js" language="javascript"></script>

<SCRIPT LANGUAGE="JavaScript1.2">
function getBrowse(element) {
  var brsWin = window.open('', 'ausgsaBrowseTop', 'toolbar=no,location=no,directories=no,status=no,dependent=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=580,height=400')
  brsWin.browseTarget = element
}
</SCRIPT>



<link rel="stylesheet" type="text/css" src="http://w3.ibm.com/ui/v8/css/v4-screen.css"></link>
<LINK REL="stylesheet" TYPE="text/css" HREF="/gsadoc/gsa.css"></LINK>
<STYLE type="text/css" media="all">
  html,body     {min-width:400px;}
</STYLE>

<!--
<STYLE type="text/css" media="all">

        @import url("http://w3.ibm.com/ui/v8/css/screen.css");
        @import url("http://w3.ibm.com/ui/v8/css/interior.css");
        @import url("http://w3.ibm.com/ui/v8/css/interior-1-col.css");
        @import url("http://w3.ibm.com/ui/v8/css/icons.css");
        @import url("http://w3.ibm.com/ui/v8/css/tables.css");

        #content-main {padding-bottom:700px; }
        h1.this-page {margin:1em 0;}
        h2.this-page {color:#05a;}
        h2.this-page a {font-size:.7em; padding-left:2em;}
        h3.this-page {margin:3px 0 .10em 0; color:#fff;}
        h3.this-page a {font-size:.7em; padding-left:2em;}

        #icons-buttons {margin:2em 1em; background:#000;}
        #icons-buttons .c1 {background:#ddd; width:10%; padding:1em; border-bottom:4px solid #000;}
        #icons-buttons .back {padding:1em;}

</STYLE>
-->

<SCRIPT LANGUAGE="JavaScript1.2">
function resetButton(form){
    form.reset();
}

function submittedForm(form){

  var src = ""
  var tgt = ""
  var dcell = ""
  var mailadd = ""
  var a = new Array();
  var origsrc = "/gsa/ausgsa/projects/c/csat"
  var dupreq = "0"
  var repreq = "0"


  src = form.PWSSourcePath.value
  tgt  = form.PWSTargetPath.value
  dcell = form.PWSDestCell.value
  links = form.PWSLinks.value
  mailadd = form.PWSPassEmail.value
  runtime = form.PWSRunSchedule.value
  starttime = form.PWSStartTime.value

  if ( runtime != "NA" ) {
     if ( src == "" ) {
        alert("The GSA source path is empty. Please enter a valid path.")
        return false;
     }

     a = src.split("/")
     if ( a[3] != "projects" && a[3] != "home" ) {
        alert("The GSA source path must be a project or home file/directory.")
        return false;
     }

     var testdot0 = /^\.\./
     results = testdot0.test(src)

     var testdot1 = /\/\.\.$/
     results1 = testdot1.test(src)

     var testdot2 = /\/\.\.\//
     results2 = testdot2.test(src)

     var testdot3 = /\/\.\//
     results3 = testdot3.test(src)

     var testdot4 = /\/\.$/
     results4 = testdot4.test(src)

     if ( results || results1 || results2 || results3 || results4 ) {
        alert("You may not use relative paths (eg. '..') in the source path.")
        return
     }

     if ( tgt == "" ) {
        alert("The GSA target path is empty. Please enter a valid path.")
        return false;
     }

     results  = testdot0.test(tgt)
     results1 = testdot1.test(tgt)
     results2 = testdot2.test(tgt)
     results3 = testdot3.test(tgt)
     results4 = testdot4.test(tgt)

     if ( results || results1 || results2 || results3 || results4 ) {
        alert("You may not use relative paths (eg. '..') in the target path.")
        return
     }

     var testquote1 = /\'/
     results1 = testquote1.test(tgt)

     var testquote2 = /\"/
     results2 = testquote2.test(tgt)

     var testquote3 = /\044/
     results3 = testquote3.test(tgt)

     if ( results1 || results2 || results3 ) {
        alert("The target path may not contain a single quote ('), double quote (\") or dollar sign ($) character.")
        return
     }

     if ( dcell == "" ) {
        alert("The target cell is empty. Please enter a valid GSA cell.")
        return false;
     }

     if ( links != "soft" && links != "safe" && links != "unsafe") {
        alert("Invalid link handling option. Valid options are 'soft', 'safe' or 'unsafe'.")
        return false;
     }

     if ( runtime != "now" && starttime == "NA") {
        alert("You must select a start time for scheduled rsync requests.")
        return false;
     }

     if ( runtime == "schedonce" ) {
        var days = 0;
        if ( form.Sun.checked ) {
           days++
        }
        if ( form.Mon.checked ) {
           days++
        }
        if ( form.Tue.checked ) {
           days++
        }
        if ( form.Wed.checked ) {
           days++
        }
        if ( form.Thu.checked ) {
           days++
        }
        if ( form.Fri.checked ) {
           days++
        }
        if ( form.Sat.checked ) {
           days++
        }
        if ( days == 0 ) {
           alert("You must select one run day for the 'schedule once' option.")
           return false;
        }
        if ( days > 1 ) {
           alert("You may select only one run day for the 'schedule once' option.")
           return false;
        }
     }
  }

  if ( runtime == "NA" ) {
     var ok = 0;
     
     if ( ok == 0 ) {
        alert("You must select a RUN SCHEDULE for new scheduled rsync requests.")
        return false;
     }
  }

  if ( src == origsrc && (runtime != "NA" && runtime != "now") ) {
     if ( repreq > 0 ) {
        if (confirm("Warning: You are about to replace an existing scheduled rsync request for this source path.  Are you sure you want to continue?")) {
        } else {
           return false
        }
     }
     if ( dupreq > 0 ) {
        if (confirm("Warning: Another user already has a scheduled rsync request for this source path.  Are you sure you want to continue?")) {
        } else {
           return false
        }
     }
  }


    return true;
}
function submitButton(form){
    if(submittedForm(form))
    form.submit();
}

</SCRIPT>
<P ALIGN="center"><a class="popup-link" style="text-align:left" href="javascript:popup('/gsadoc/help/popup-rsync.html','internal',500,400)">Quick Help</a></P>
<FORM ACTION=../backend/fm_rsync.cgi METHOD=Post ENCTYPE=application/x-www-form-urlencoded ONSUBMIT="javascript:submittedForm(document.forms.GSAToolForm)" TARGET=ausgsaTaskWin NAME=GSAToolForm>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=80%>
<TR ALIGN=CENTER><td>
  <B>Rsync</B>
</TD></TR>
</TABLE>
<BR>
<CENTER>
  <TABLE CLASS="basic-table" BORDER=0 CELLSPACING=0 CELLPADDING=0>
  <TR class="even">
    <TD ALIGN=CENTER VALIGN=CENTER><TABLE BORDER=0 CELLSPACING=0 CELLPADDING=2>
<TR><TD align=left><B>Run Schedule:  </B><SELECT NAME=PWSRunSchedule onChange='reloadForm(this.form)'><option value="now">Run Now Once<option value="schedonce">Schedule Once<option value="repeat">Schedule Repeating</SELECT></TD></TR>
<TR><TD align=left><B>Source Path:  </B><INPUT TYPE=text NAME=PWSSourcePath SIZE=40 VALUE="/gsa/ausgsa/projects/c/csat"></TD></TR>
<TR><TD align=left><B>Target Cell(s) [TGTCELL]: </B><INPUT TYPE=text NAME=PWSDestCell SIZE=23 VALUE=""></TD></TR>
<TR><TD align=left><B>Target Path:  </B><INPUT TYPE=text NAME=PWSTargetPath SIZE=40 VALUE="/gsa/[TGTCELL]/projects/c/csat"></TD></TR>
<TR><TD align=left><B>Link Handling:  </B><SELECT NAME=PWSLinks> <option value="soft">soft-links<option value="safe">safe-links<option value="unsafe">copy-unsafe-links</SELECT></TD></TR>
<TR><TD align=left><B>Copy ACLs:  </B><SELECT NAME=PWSCopyACLs> <option value="no">No<option value="yes">Yes</SELECT></TD></TR>
<TR><TD align=left><B>Mirror Files:  </B><INPUT TYPE=checkbox NAME=PWSMirror VALUE=yes> (delete data on destination cell not on source cell)</TD></TR>
<TR><TD align=left><B>Completion E-mail address(es) [userid@CN.ibm.com]:</B><BR><INPUT TYPE=text NAME=PWSPassEmail SIZE=35 VALUE="fdemarco@us.ibm.com"></TD></TR>
<TR><TD align=left><B>Failure E-mail address(es) [userid@CN.ibm.com]:</B><BR><INPUT TYPE=text NAME=PWSFailEmail SIZE=35></TD></TR></TABLE></TD>
  </TR>
  <TR class="even">
    <TD ALIGN=LEFT VALIGN=CENTER><TABLE BORDER=0 CELLSPACING=0 CELLPADDING=2>
<TR><TD><FONT COLOR=GREEN SIZE=-1><B>Start Time:</B></TD><TD ALIGN=LEFT><SELECT NAME=PWSStartTime><option value="NA">NA<option value="00">00<option value="01">01<option value="02">02<option value="03">03<option value="04">04<option value="05">05<option value="06">06<option value="07">07<option value="08">08<option value="09">09<option value="10">10<option value="11">11<option value="12">12<option value="13">13<option value="14">14<option value="15">15<option value="16">16<option value="17">17<option value="18">18<option value="19">19<option value="20">20<option value="21">21<option value="22">22<option value="23">23</SELECT></TD>
</TD></TR>
<TR><TD COLSPAN=2><FONT COLOR=GREEN SIZE=-1><B>Run On Days:  </B></TD><TD><FONT COLOR=GREEN SIZE=-1><B>Sun</TD><TD><FONT COLOR=GREEN SIZE=-1><B>Mon</TD><TD><FONT COLOR=GREEN SIZE=-1><B>Tue</TD><TD><FONT COLOR=GREEN SIZE=-1><B>Wed</TD><TD><FONT COLOR=GREEN SIZE=-1><B>Thu</TD><TD><FONT COLOR=GREEN SIZE=-1><B>Fri</TD><TD><FONT COLOR=GREEN SIZE=-1><B>Sat</B>
</TD></TR>
<TR><TD COLSPAN=2></TD><TD><INPUT TYPE=checkbox NAME=Sun VALUE=sun></TD><TD><INPUT TYPE=checkbox NAME=Mon VALUE=mon></TD><TD><INPUT TYPE=checkbox NAME=Tue VALUE=tue></TD><TD><INPUT TYPE=checkbox NAME=Wed VALUE=wed></TD><TD><INPUT TYPE=checkbox NAME=Thu VALUE=thu></TD><TD><INPUT TYPE=checkbox NAME=Fri VALUE=fri></TD><TD><INPUT TYPE=checkbox NAME=Sat VALUE=sat></TD>
</TD></TR></TABLE></TD>
  </TR>
  <TR>
    <TD ALIGN=CENTER COLSPAN=2>
         <span class="button-blue"><input type="button" value="Submit" onClick="submitButton(document.forms.GSAToolForm)"></span>

         <span class="button-blue"><input type="button" value="Cancel" onclick="top.close()"></span>

<!--
       <A HREF=javascript:submitButton(document.forms.GSAToolForm)><IMG BORDER=0 SRC="/gsatools/images/wsmsubmit.gif" ALT="Submit" TITLE="Submit"></A>
       <A HREF=javascript:javascript:top.close()><IMG BORDER=0 SRC="/gsatools/images/wsmcancel.gif" ALT="Cancel" TITLE="Cancel"></A>
-->
    </TD>
  </TR>

  <TR><TD>
  <TABLE BORDER=0 CELLSPACING=2 CELLPADDING=2>
    
  </TD></TR>


  </TABLE>
  <TR><TD>
  <TABLE BORDER=0 CELLSPACING=2 CELLPADDING=2>
    
  </TD></TR>

  </TABLE>
</CENTER>
<BR>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0>
  <TR>
     <TD ALIGN=CENTER><FONT SIZE=-1><b> </b><BR> </TD>
  </TR>
  <TR>
    <TD ALIGN=LEFT WIDTH=400><FONT COLOR=BLUE SIZE=-1><OL></OL></FONT></TD>
  </TR>
</TABLE>

</FORM>
<SCRIPT LANGUAGE="JavaScript1.2">

// <!-- Begin 
function explain_rs_man(name, output, msg) {newwin = window.open('','','top=150,left=150,width=425,height=350');
if (!newwin.opener) newwin.opener = self;
with (newwin.document)
{
open();
write('<html>');
write('<BODY bgcolor="white">');
write('<form name=form>' + msg + '<br>');
write('<p><input type=button value="Click for more help" onClick=window.open("../../gsadoc/help/fm.shtml#query")>');
write('<p><input type=button value="Click to close" onClick=window.close()>');
write('</center></form></body></html>');
close();
   }
}
//End -->


function reloadForm(form) {
  var foo = form.PWSStartTime.value;
  if ( foo == "Schedule" ) {
     form.PWSStartTime.focus;
  } else {
     form.PWSStartTime.blur;
  }
}

if ( "foundhome" != "foundhome" ) {
    alert("You must have a home directory on this cell in order to run Rsync.");
    close();
}



</SCRIPT>

</CENTER>
<!--END CONTENT SHELL-->
</body>
</html>
